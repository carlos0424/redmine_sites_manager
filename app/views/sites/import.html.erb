<%# app/views/sites/import.html.erb %>
<div class="contextual">
  <%= link_to l('plugin_sites_manager.sites.download_template'), 
              download_template_sites_path,
              class: 'icon icon-download button' %>
</div>

<h2><%= l('plugin_sites_manager.sites.import') %></h2>

<div class="box tabular">
  <div class="import-instructions">
    <h3><%= l('plugin_sites_manager.sites.instructions') %></h3>
    <ol>
      <li><%= l('plugin_sites_manager.sites.instruction_template') %></li>
      <li><%= l('plugin_sites_manager.sites.instruction_fill') %></li>
      <li><%= l('plugin_sites_manager.sites.instruction_save') %></li>
      <li><%= l('plugin_sites_manager.sites.instruction_upload') %></li>
    </ol>

    <div class="flash notice">
      <strong><%= l('plugin_sites_manager.sites.required_fields') %>:</strong>
      <ul>
        <li>S ID (<%= l('plugin_sites_manager.fields.s_id') %>)</li>
        <li><%= l('plugin_sites_manager.fields.nom_sitio') %></li>
      </ul>
    </div>
  </div>

  <%= form_tag import_sites_path, multipart: true, class: 'import-form' do %>
    <p>
      <label><%= l('plugin_sites_manager.sites.select_file') %></label>
      <%= file_field_tag :file, 
                        accept: '.csv',
                        class: 'file-input',
                        required: true %>
      <em class="info"><%= l('plugin_sites_manager.sites.file_format') %></em>
    </p>

    <div class="form-actions">
      <%= submit_tag l('plugin_sites_manager.sites.import_button'), 
                    class: 'button-positive',
                    data: { 
                      disable_with: l('plugin_sites_manager.sites.importing')
                    } %>
      <%= link_to l(:button_cancel), sites_path, class: 'button' %>
    </div>
  <% end %>
</div>

<% content_for :header_tags do %>
  <%= javascript_include_tag 'sites_import', plugin: 'redmine_sites_manager' %>
  <style>
    .import-instructions {
      margin-bottom: 2em;
      padding: 1em;
      background-color: #f9f9f9;
      border: 1px solid #e0e0e0;
      border-radius: 3px;
    }
    .import-instructions ol {
      margin-left: 1.5em;
    }
    .import-instructions li {
      margin-bottom: 0.5em;
    }
    .import-spinner {
      margin-left: 1em;
      animation: spin 2s linear infinite;
    }
    @keyframes spin {
      100% { transform: rotate(360deg); }
    }
    .flash.notice ul {
      margin-left: 1.5em;
      list-style-type: disc;
    }
  </style>
<% end %>